{
  "content": "/**\n * Clears email form widgets after sending an email.\n * @param {Object} formWidgets - widgets of form.\n */\nfunction cleanEmailForm(pageWidgets) {\n  pageWidgets.ToTextBox.value \u003d null;\n  pageWidgets.SubjectTextBox.value \u003d null;\n  pageWidgets.BodyTextEditor.value \u003d null;\n}\n\n\n/**\n * Clears email template form widgets after sending an email with template.\n * @param {Object} formWidgets - widgets of form.\n */\nfunction cleanTemplateForm(pageWidgets) {\n  pageWidgets.TemplateToTextBox.value \u003d null;\n  pageWidgets.TemplateSubjectTextBox.value \u003d null;\n  pageWidgets.TemplateTextArea.value \u003d null;\n  pageWidgets.RecepientNameTextBox.value \u003d null;\n  pageWidgets.AppNameTextBox.value \u003d null;\n}\n\n\n/**\n * Calls a server method to send an email.\n * @param {Widget} sendButton - widget that triggered the action.\n */\nfunction sendEmailMessage(sendButton) {\n  if (!sendButton.root.descendants.SendEmailFormPanel.validate()) {\n    return;\n  }\n\n  var pageWidgets \u003d sendButton.root.descendants;\n  var props \u003d sendButton.root.properties;\n\n  props.SendingEmail \u003d true;\n  google.script.run\n    .withSuccessHandler(function() {\n      cleanEmailForm(pageWidgets);\n      app.datasources.RemainingDailyQuota.load();\n      props.SendingEmail \u003d false;\n    })\n    .withFailureHandler(function(err) {\n      console.error(JSON.stringify(err));\n      props.SendingEmail \u003d false;\n    })\n    .sendEmail(\n      pageWidgets.ToTextBox.value,\n      pageWidgets.SubjectTextBox.value,\n      pageWidgets.BodyTextEditor.value);\n}\n\n\n/**\n * Calls a server method to send an email with template.\n * @param {Widget} sendButton - widget that triggered the action.\n */\nfunction sendTemplateEmailMessage(sendButton) {\n  if (!sendButton.root.descendants.TemplateEmailFormPanel.validate()) {\n    return;\n  }\n\n  var pageWidgets \u003d sendButton.root.descendants;\n  var props \u003d sendButton.root.properties;\n\n  props.SendingTemplateEmail \u003d true;\n  google.script.run\n    .withSuccessHandler(function() {\n      cleanTemplateForm(pageWidgets);\n      app.datasources.RemainingDailyQuota.load();\n      props.SendingTemplateEmail \u003d false;\n    })\n    .withFailureHandler(function(err) {\n      console.error(JSON.stringify(err));\n      props.SendingTemplateEmail \u003d false;\n    })\n    .sendTemplateEmail(\n      pageWidgets.TemplateToTextBox.value,\n      pageWidgets.TemplateSubjectTextBox.value,\n      pageWidgets.TemplateTextArea.value,\n      {\n        recepientName: pageWidgets.RecepientNameTextBox.value,\n        appName: pageWidgets.AppNameTextBox.value\n      }\n  );\n}",
  "key": "lieZU7YnA79WsD70urGspBIasuG3kUb9",
  "name": "ClientScript",
  "type": "CLIENT"
}